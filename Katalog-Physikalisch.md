# Katalog Physikalisch
 
_Physikalische Angriffe zielen darauf ab, die Hardware selbst zu manipulieren, um unautorisierten Zugriff auf das System oder sensible Informationen zu erlangen. Typische physikalische Angriffe auf Hardware umfassen Tampering, Side-Channel-Angriffe oder Fault-Injection. Diese Angriffe können genutzt werden, um Schwachstellen in OT-Systemen aufzudecken und sensible Daten wie Passwörter oder Schlüssel zu stehlen. Einige Angriffe können auch dazu führen, dass das System nicht mehr ordnungsgemäß funktioniert oder komplett ausfällt._

| Test-Modul | Modulbeschreibung | Test-Durchführung | Externer Angriff möglich? | Aggressivität | Externe Quellen |
|------------|-------------------|-------------------|---------------------------|---------------|-----------------|
| **P.1** - JTAG Interface | Zugriff über die JTAG Schnittstelle als Administrator auf das System oder eine einzelne Komponente ermöglichen ein umfangreiches Debugging und ermöglicht so ein Umgehen von implementierten Sicherheitsmaßnahmen. Diese Schnittstellen werden meist während der Entwicklung zur Fehlerbehebung benötigt, aber erfüllen meist keine Funktionalität in Produktion, weswegen diese deaktiviert oder verschlüsselt werden sollten. | Um die Sicherheit der JTAG Schnittstellen zu überprüfen, müssen diese zunächst identifiziert werden. Hierzu kann das Tool [JTAGulator](https://github.com/grandideastudio/jtagulator) genutzt werden. Sind diese Schnittstellen identifizieren kann, mit beispielsweise [JTAGenum](https://github.com/cyphunk/JTAGenum), die verwendeten Befehle enumeriert und gegebenenfalls ausgenutzt werden. | Nein | Aggressiv | [Exploiting JTAG](https://www.researchgate.net/publication/329373688_Exploiting_JTAG_and_its_mitigation_in_IOT_A_survey)<br><br>[Guide To Understanding Jtag Fuses and Security](https://de.scribd.com/document/125950834/GUIDE-TO-UNDERSTANDING-JTAG-FUSES-AND-SECURITY)<br><br>[JTAGulator](https://github.com/grandideastudio/jtagulator)<br><br>[JTAGenum](https://github.com/cyphunk/JTAGenum) |
| **P.2** - Side Channel Attacks | Side-Channel-Angriffe zielen darauf ab, geheime Informationen wie Passwörter oder Schlüssel durch beispielsweise Analyse des Energieverbrauchs, der elektromagnetischen Strahlung oder des Timing-Verhaltens zu ermitteln. Es ist wichtig, dass OT-Systeme angemessen gegen solche Angriffe gesichert werden, um unautorisierten Zugriff oder Informationsfluss zu verhindern. | Side-Channel-Angriffe sind in der Praxis schwierig durchzuführen und größtenteils zeitaufwändig. Darüber hinaus werden zur Verbrauchs- oder elektromagnetischen Abstrahlungsmessung spezielle Geräte benötigt, die einen solchen Angriff recht schwierig durchzuführen. Zur Hilfestellung kann unter anderem das Tool [ChipWhisperer](https://github.com/newaetech/chipwhisperer) genutzt werden. | Nein | Abwägend | [Side-Channel Resistance](https://www.bsi.bund.de/EN/Themen/Unternehmen-und-Organisationen/Informationen-und-Empfehlungen/Kryptografie/Seitenkanalresistenz/seitenkanalresistenz_node.html)<br><br>[Hacker's guide to deep-learning side-channel attacks](https://elie.net/blog/security/hacker-guide-to-deep-learning-side-channel-attacks-the-theory/)<br><br>[ChipWhisperer](https://github.com/newaetech/chipwhisperer) |
| **P.3** - Fault Injection Attacks | Fault Injection-Attacken manipulieren die physische Umgebung eines Geräts, um unerwartete Fehler zu verursachen, die dazu führen können, dass das Gerät sich anders verhält als vorgesehen. Hierbei können Angreifer beispielsweise Stromausfälle oder elektromagnetische Interferenzen auslösen, um fehlerhafte Ergebnisse zu erzielen. | Fault Injection Attacks gehen meist mit Side-Channel Attacks einher und sind daher meist genauso technisch aufwendig durchzuführen. Unter anderem kann dazu das Tool [ChipSHOUTER](https://github.com/newaetech/ChipSHOUTER) genutzt werden. | Nein | Aggressiv | [Introduction to Fault Injection](https://research.nccgroup.com/2021/07/07/an-introduction-to-fault-injection-part-1-3/)<br><br>[ChipSHOUTER](https://github.com/newaetech/ChipSHOUTER) |
| **P.4** - GPIO Interfaces | Angriffe auf GPIO-Pins zielen darauf ab, diese zu manipulieren, um unautorisierten Zugriff oder Kontrolle über OT-Systeme zu erlangen. Es ist wichtig, dass die GPIO-Pins in OT-Systemen angemessen abgesichert werden, um unautorisierte Manipulationen zu verhindern. Wenn diese Schnittstellen keine Funktionalität in Produktion besitzen, dann sollten diese deaktiviert werden. | Da GPIO-Pins von der Hardware selbst verwaltet, ist an dieser Stelle ein individuelles Vorgehen gefordert. Über bekannte Mikrocontroller wie einem Raspberry Pi können die GPIO-Pins angesprochen und ausgelesen werden. | Nein | Aggressiv | [Introduction to GPIO](https://nerdyelectronics.com/introduction-to-gpio/)<br><br>[Linux Kernal GPIO Docs](https://docs.kernel.org/driver-api/gpio/intro.html) |
| **P.5** - UART Interfaces | UART Schnittstellen werden zur seriellen Kommunikation zwischen Systemen verwendet und können, wenn diese nicht abgesichert sind, administrativen Zugang zu dem Gerät liefern. Ähnlich zu JTAG wird UART überwiegend zur Fehlerbehebung während der Entwicklung verwendet und erfüllt in Produktion keinen aktiven Nutzen. Wenn dies der Fall ist, dann sollten auch die UART-Schnittstellen deaktiviert werden. | UART erfordert ein ebenso individuelles Vorgehen wie bei GPIO-Schnittstellen. Eine Hilfestellung können dabei die Scripte des [UART Hacking](https://github.com/Merimetso-Code/UART-Hacking) Tool liefern. | Nein | Abwägend | [UART Attack Surface](https://payatu.com/masterclass/iot-security-part-17-101-hardware-attack-surface-uart/)<br><br>[UART Hacking](https://github.com/Merimetso-Code/UART-Hacking) |
| **P.6** - SPI Interfaces | Viele Mikrocontroller erlauben In-System-Programmierung über SPI oder auch JTAG. Angriffe auf das SPI-Interface können dazu genutzt werden, unautorisierten Zugriff auf das System zu erlangen oder Daten auszulesen. Nach der initialen Konfiguration sollte die Schnittstelle angemessen verschlüsselt und gegen unautorisierte Zugriffe abgesichert werden. | Für SPI Schnittstellen gilt ein ähnliches Vorgehen wie bei den zuvor genannten Schnittstellen. Ausführliches individuelles Testen ist notwendig und für verschiedene Szenarien kann das [SPITool](https://github.com/chrschmidt/spitool) genutzt werden. | Nein | Aggressiv | [SPI Deep Dive](https://hackaday.com/2021/09/16/taking-a-deep-dive-into-spi/)<br><br>[SPI Attack Surface](https://payatu.com/blog/hardware-attack-surface-spi/) |
| **P.7** - Tampering | Tampering bezieht sich auf den physischen Eingriff in Hardware-Komponenten, z.B. das Öffnen des Geräts oder das Entfernen von Chips, um sensible Daten wie Passwörter oder Schlüssel zu extrahieren oder das Gerät zu manipulieren. Unter anderem können auch Geräte, die der Angreifer kontrolliert, in Systeme eingeschleust werden und so weitere Angriffe ermöglichen. | Zunächst kann eine physische Untersuchung der Hardware-Komponenten durchgeführt werden, um mögliche Schwachstellen zu erkennen, die durch Manipulationen an der Hardware ausgenutzt werden könnten. Hierbei kann beispielsweise die Überprüfung von Siegeln, Schrauben und anderen Verschlüssen erfolgen, um Anzeichen von Manipulationen zu erkennen. Außerdem kann eigene Hardware zwischen Komponenten platziert werden, um weitere Angriffe vorzubereiten. | Nein | Aggressiv | [NIST Developing Hardware Security Guidlines for Enterprise](https://duo.com/decipher/nist-developing-hardware-security-guidelines-for-enterprises)<br><br>[Supply-Chain Risks](https://dl.acm.org/doi/abs/10.5555/3381569.3381611) |
| **P.8** - Direct Memory Access | DMA ermöglicht es Daten direkt zwischen Speichergeräten und Peripheriegeräten zu übertragen, ohne dass dabei die CPU beteiligt ist. Durch den direkten Zugriff auf den Speicher können DMA-fähige Geräte Daten schneller übertragen und gleichzeitig die CPU entlasten. DMA kann jedoch auch genutzt werden, um unautorisierten Zugriff auf den Speicher zu erlangen oder sensible Informationen zu stehlen. | Zunächst muss eine physische Untersuchung der Hardware-Komponenten durchgeführt werden, um mögliche Schwachstellen zu erkennen, die durch unautorisierten DMA-Zugriff ausgenutzt werden könnten. Hierbei kann beispielsweise die Überprüfung von Zugriffskontrollmechanismen und anderen Schutzvorrichtungen erfolgen. Meist werden, wie bei den meisten physischen Angriffen, weitere Hardware-Komponenten wie Mikrocontroller benötigt. Wenn DMA über PCIe angreifbar ist, kann mit Hilfe des Tools [PCILeech](https://github.com/ufrisk/pcileech), der Speicher ausgelesen werden. | Nein | Abwägend | [DMA Attacks](https://eclypsium.com/research/direct-memory-access-attacks-a-walk-down-memory-lane/)<br><br>[PCILeech](https://github.com/ufrisk/pcileech) |

## Weitere Quellen

### Tools
- [JTAGulator](https://github.com/grandideastudio/jtagulator): Der JTAGulator ist ein Tool zur Identifizierung und Diagnose von JTAG-Schnittstellen auf einer Vielzahl von Geräten. Es ermöglicht das automatische Scannen einer Vielzahl von JTAG-Pins und die Identifizierung der korrekten Konfiguration für die JTAG-Kommunikation.
- [JTAGenum](https://github.com/cyphunk/JTAGenum): JTAGenum ist ein Open-Source-Tool zur Identifizierung und Analyse von JTAG-Schnittstellen auf verschiedenen Geräten. Das Tool nutzt eine Vielzahl von Techniken, um JTAG-Scans durchzuführen und die richtigen Konfigurationen für die JTAG-Kommunikation zu identifizieren. Es ermöglicht die Extraktion von Informationen über das Gerät, die Durchführung von Memory-Dumps und das Ausführen von Code auf der Zielhardware. 
- [ChipWhisperer](https://github.com/newaetech/chipwhisperer): 
ChipWhisperer ist ein Open-Source-Tool zur Analyse von Side-Channel-Angriffen auf Hardware-Komponenten. Das Tool ermöglicht es, verschiedene Angriffsszenarien durchzuführen, wie zum Beispiel das Abfangen und Analysieren von Strom- oder EM-Signalen, um verschlüsselte Daten oder geheime Schlüssel zu extrahieren.
- [ChipSHOUTER](https://github.com/newaetech/ChipSHOUTER): 
ChipSHOUTER ist ein Tool zur Durchführung von Side-Channel-Angriffen auf Hardware-Komponenten, das auf der Nutzung von elektromagnetischer Strahlung basiert. Es ermöglicht das Auslesen von vertraulichen Informationen, indem es die elektromagnetischen Signale auf der Leiterplatte der Hardware-Komponente analysiert.
- [UART Hacking](https://github.com/Merimetso-Code/UART-Hacking): UART Hacking stellt eine Sammlung an verschiedenen Python Skripten bereit, die es ermöglichen die verwendeten Befehle zu Brute-Forcen oder Befehle auf dem Zielgerät auszuführen.
- [SPITool](https://github.com/chrschmidt/spitool): SPITool ermöglicht das mitlesen und manipulieren von SPI-Paketen. Des Weiteren können EEPROM-Speicher ausgelesen und gespeichert werden, was eine weitere Analyse der Speicherdaten ermöglicht. 
- [PCILeech](https://github.com/ufrisk/pcileech): PCILeech verwendet PCIe-Hardwaregeräte, um den Speicher des Ziel-Systems auszulesen und zu schreiben. Dies wird durch die Verwendung von DMA über PCIe erreicht.